// 陣列size #########################################################################################################
#include <iostream>
#include <vector>
#include <type_traits>

using namespace std;

int main() {
    int arr[3][4][5];
    cout << extent_v<decltype(arr), 0> << " ";
    cout << extent_v<decltype(arr), 1> << " ";
    cout << extent_v<decltype(arr), 2> << "\n";
}

size_t dim1 = sizeof(arr) / sizeof(arr[0]);
size_t dim2 = sizeof(arr[0]) / sizeof(arr[0][0]);
size_t dim3 = sizeof(arr[0][0]) / sizeof(arr[0][0][0]);

vector<vector<vector<int>>> v3;
dim1 = v3.size();
dim2 = v3[0].size();
dim3 = v3[0][0].size();

// 陣列賦值 #########################################################################################################
int a[5];
a = {1, 3, 5, 9, 1};  // 賦值不合法


int a[5] = {1, 3, 5, 9, 1};  // 合法

// 用 std::array (大小固定、在編譯期已知，可用range-based for loop)
array<int, 5> a = {1, 3, 5, 9, 1};
a = {2, 4, 6, 8, 10}; // 重新賦值

// 用 vector (大小可變)
vector<int> a = {1,2,3,4,5};
a = {6,7,8}; // 重新賦值

// 動態分配 #########################################################################################################
#include <iostream>
using namespace std;

int main() {
    int* a = new int[5]{1, 3, 5, 9, 1};
    for (size_t i = 0; i < 5; ++i) cout << a[i] << " "; // 無法用 range-based for loop，指標 int* a 只是位址，不帶有大小資訊，編譯器不知道 container的 begin() 和 end()
	cout << "\n";

    delete[] a;
	a=NULL;
    
    a = new int[5]{2, 4, 6, 8, 10};  // 重新賦值
    for (size_t i = 0; i < 5; ++i) cout << a[i] << " ";
    cout << "\n";
	
    delete[] a;
    a=NULL;
    return 0;
}
// 動態分配 #########################################################################################################
// old
int* arr = new int[100];
arr[0] = 42;
delete[] arr; // 釋放記憶體
arr = nullptr; 

// new
std::unique_ptr<int[]> arr(new int[100]); // 不須 delete[]
arr[0] = 42;
// 動態分配 #########################################################################################################
#include <iostream>
using namespace std;

int main() {
    
    int rows = 2, cols = 2;
    
    // 宣告
    int** a = new int*[rows];
    for(size_t i = 0; i < rows; ++i)
        a[i] = new int[cols]();  // 加括號()初始化為int 初始值0。不加括號不進行初始化，數值是記憶體的殘存值。
    
    // assign value
    int value = 1;
    for (size_t i = 0; i < rows; ++i)
        for (size_t j = 0; j < cols; ++j)
            a[i][j] = value++;

    // print
    for (size_t i = 0; i < rows; ++i) {
        for (size_t j = 0; j < cols; ++j)
            cout << a[i][j] << " ";
        cout << endl;
    }
    
    // 釋放記憶體
    for(size_t i = 0; i < rows; ++i)
        delete[] a[i];
    delete[] a;
    return 0;
}


// C++版本  ##############################################################################
#include <iostream>
using namespace std;
int main() {
    cout << "C++ version: " << __cplusplus << endl;
    return 0;
}

// 將指標、大小封裝在 span (C++20) ##############################################################################
#include <iostream>
#include <span>
using namespace std;

int main() {
    int* a = new int[5]{1, 3, 5, 9, 1};
    span<int> s(a, 5);

    for (auto x : s) cout << x << " ";

    delete[] a;
    return 0;
}


// range-based for loop 賦值、print ###########################################################################
#include <iostream>
#include <vector>
using namespace std;

int main() {
    vector<int> a(5);
    
    int value = 1;
    for(auto& elem: a) elem = value++; //使用參照才會改到a的值，沒有用參照只會改elem
    
    for(const auto& elem: a) cout << elem << " "; // 使用const確保不更動a的值 // 使用參照避免copy，提升效能
    cout << "\n";

    return 0;
}

// #########################################################################################################
#include <iostream>
using namespace std;

int main() {
    cout << "----------------------------------------------------" << endl;


    int i,j,sum=0;
    int arr[2][4]={{30,35,26,32},{33,34,30,29}};

    int rows = sizeof(arr) / sizeof(arr[0]);
    int cols = sizeof(arr[0]) / sizeof(arr[0][0]);

    for (size_t i = 0; i < rows; i++)
    {
        for (size_t j = 0; j < cols; j++)
        {
            cout << arr[i][j] << " ";
            sum+=arr[i][j];
        }
        cout << endl;
    }
    cout << sum << endl;


    cout << "----------------------------------------------------" << endl;
    return 0;
}

// 動態分配二維陣列  #########################################################################################################
#include <iostream>
using namespace std;

int main() {
    cout << "----------------------------------------------------" << endl;

    int data[2][4] = {{30, 35, 26, 32}, {33, 34, 30, 29}};
    int rows = sizeof(data) / sizeof(data[0]);
    int cols = sizeof(data[0]) / sizeof(data[0][0]);

    // 動態分配二維陣列
    int** arr = new int*[rows];
    for (int i = 0; i < rows; ++i)
    {
        arr[i] = new int[cols]();
        for (int j = 0; j < cols; ++j)
            arr[i][j] = data[i][j];
    }
    

    for (int i = 0; i < rows; ++i)
    {
        for (int j = 0; j < cols; ++j)
            cout << arr[i][j] << " ";
        cout << endl;
    }

    // 釋放記憶體
    for (int i = 0; i < rows; ++i)
        delete[] arr[i];
    delete[] arr;


    cout << "----------------------------------------------------" << endl;
    return 0;
}

// vector #########################################################################################################
#include <iostream>
#include <vector>
using namespace std;

int main() {
    cout << "----------------------------------------------------" << endl;

    vector<int> v1 = {1, 2, 3};
    vector<int> v2 = {4, 5, 6};
	vector<vector<int>> vv = {v1, v2};
    // vector<vector<int>> arr(rows, vector<int>(cols));
	

	for (const auto& inner_vec : vv)
	{
        for (int num : inner_vec)
            cout << num << " ";
        cout << endl;
    }

    cout << "----------------------------------------------------" << endl;
    return 0;
}


// 3 dim vector #########################################################################################################
#include <iostream>
#include <vector>

using namespace std;

void printArray1(const vector<vector<vector<int>>>&);
void printArray2(const vector<vector<vector<int>>>&);

int main() {
    cout << "----------------------------------------------------" << endl;

    vector<vector<int>> v1 = {{1, 2, 3, 4},
                              {5, 6, 7, 8},
                              {9, 10, 11, 12}};
    vector<vector<int>> v2 = {{13, 14, 15, 16},
                              {17, 18, 19, 20},
                              {21, 22, 23, 24}};
    vector<vector<vector<int>>> vvv(2, vector<vector<int>>(3, vector<int>(4, 0)));
    printArray2(vvv);
    vvv = {v1, v2};
    printArray2(vvv);

    cout << "----------------------------------------------------" << endl;
    return 0;
}
// index
void printArray1(const vector<vector<vector<int>>>& arr)
{
    for (size_t i = 0; i < arr.size(); ++i) {
        cout << "Layer " << i << ":\n";
        for (size_t j = 0; j < arr[i].size(); ++j) {
            for (size_t k = 0; k < arr[i][j].size(); ++k)
                cout << arr[i][j][k] << " ";
            cout << "\n";
        }
        cout << "\n";
    }
}
// range-based for loop
void printArray2(const vector<vector<vector<int>>>& arr)
{
    int layerIndex = 0;
    for (const auto& layer : arr) {
        cout << "Layer " << layerIndex++ << ":\n";
        
        for (const auto& row : layer) {
            for (const auto& element : row)
                cout << element << " ";
            cout << "\n";
        }
        cout << "\n";
    }
}



// typedef #########################################################################################################
typedef vector<vector<vector<int>>> Vec3D;
Vec3D vvv(2, vector<vector<int>>(3, vector<int>(4, 0)));

// template create_vector #########################################################################################################
#include <iostream>
#include <vector>
using namespace std;

template <typename T>
vector<T> create_vector(int size) {
    return vector<T>(size);
}

template <typename T, typename... Sizes>
auto create_vector(int first, Sizes... sizes) {
    return vector<decltype(create_vector<T>(sizes...))>(first, create_vector<T>(sizes...));
}

void printArray(const vector<int>&);
void printArray(const vector<vector<int>>&);
void printArray(const vector<vector<vector<int>>>&);

int main() {
    cout << "----------------------------------------------------" << endl;

    // create 1-dim vector
    auto v = create_vector<int>(3);
    int value = 1;
    for (auto& elem : v) elem = value++;

    // create 2-dim vector
    auto vv = create_vector<int>(2, 5);
    value = 1;
    for (auto& row : vv)
        for (auto& elem : row)
            elem = value++;

    // create 3-dim vector
    auto vvv = create_vector<int>(2, 3, 4);
    value = 1;
    for (auto& layer : vvv)
        for (auto& row : layer)
            for (auto& elem : row)
                elem = value++;


    // print 1-dim vector
    cout << "1-dim:" << endl;
    printArray(v);
    cout << "\n";

    // print 2-dim vector
    cout << "2-dim:" << endl;
    printArray(vv);
    cout << "\n";

    // print 3-dim vector
    cout << "3-dim:" << endl;
    printArray(vvv);

    cout << "----------------------------------------------------" << endl;
    return 0;
}

void printArray(const vector<int>& arr) {
    for (const auto& elem : arr)
        cout << elem << " ";
	cout << "\n";
}
void printArray(const vector<vector<int>>& arr) {
    for (const auto& row : arr) {
        for (const auto& elem : row)
            cout << elem << " ";
        cout << "\n";
    }
}
void printArray(const vector<vector<vector<int>>>& arr) {
    int layerIndex = 0;
    for (const auto& layer : arr) {
        cout << "Layer " << layerIndex++ << ":\n";
        
        for (const auto& row : layer) {
            for (const auto& elem : row) {
                cout << elem << " ";
            }
            cout << "\n";
        }
        cout << "\n";
    }
}


// matrixMultiply vector #########################################################################################################
#include <iostream>
#include <vector>
using namespace std;

vector<vector<int>> matrixMultiply(const vector<vector<int>>&, const vector<vector<int>>&);
void PrintMatrix(const vector<vector<int>>&);

int main() {
    cout << "----------------------------------------------------" << endl;

    vector<vector<int>> A = {{3,2,1}, {5,6,7}, {2,4,6}};
    vector<vector<int>> B = {{2,3}, {3,4}, {6,2}};
    vector<vector<int>> C;

    C = matrixMultiply(A,B);
    PrintMatrix(C);

    cout << "----------------------------------------------------" << endl;
    return 0;
}
vector<vector<int>> matrixMultiply(const vector<vector<int>>& A, const vector<vector<int>>& B)
{
    int m = A.size();
    int n = A[0].size();
    int p = B[0].size();

    vector<vector<int>> C(m, vector<int>(p,0));

    for (size_t i = 0; i < m; i++)
        for (size_t j = 0; j < p; j++)
            for (size_t k = 0; k < n; k++)
                C[i][j] += A[i][k] * B[k][j];

    return C;
}
void PrintMatrix(const vector<vector<int>>& A)
{
    for (const auto& row : A) {
        for (const auto& elem : row)
            cout << elem << " ";
        cout << "\n";
    }
}


// matrixMultiply C array #########################################################################################################
#include <iostream>
using namespace std;

void matrixMultiply(int** A, int** B, int** C, int m, int n, int p);
void PrintMatrix(int** A, int m, int p);
int** createMatrix(int rows, int cols);

int main() {
    cout << "----------------------------------------------------" << endl;

    int m = 3, n = 3, p = 2;

    int** A = createMatrix(m, n);
    int** B = createMatrix(n, p);
    int** C = createMatrix(m, p);

    cout << "A初始值: " << endl;
    PrintMatrix(A, m, p);
    cout << endl;

    A[0][0] = 3; A[0][1] = 2; A[0][2] = 1;
    A[1][0] = 5; A[1][1] = 6; A[1][2] = 7;
    A[2][0] = 2; A[2][1] = 4; A[2][2] = 6;

    B[0][0] = 2; B[0][1] = 3;
    B[1][0] = 3; B[1][1] = 4;
    B[2][0] = 6; B[2][1] = 2;

    matrixMultiply(A, B, C, m, n, p);
    cout << "C: " << endl;
    PrintMatrix(C, m, p);
    cout << endl;

    for (int i = 0; i < m; i++) {
        delete[] A[i];
    }
    delete[] A;

    for (int i = 0; i < n; i++) {
        delete[] B[i];
    }
    delete[] B;

    for (int i = 0; i < m; i++) {
        delete[] C[i];
    }
    delete[] C;


    cout << "----------------------------------------------------" << endl;
    return 0;
}

void matrixMultiply(int** A, int** B, int** C, int m, int n, int p) {
    for (int i = 0; i < m; i++) {
        for (int j = 0; j < p; j++) {
            C[i][j] = 0;
            for (int k = 0; k < n; k++) {
                C[i][j] += A[i][k] * B[k][j];
            }
        }
    }
}

void PrintMatrix(int** A, int m, int p) {
    for (int i = 0; i < m; i++) {
        for (int j = 0; j < p; j++)
            cout << A[i][j] << " ";
        cout << "\n";
    }
}

int** createMatrix(int rows, int cols) {
    int** matrix = new int*[rows];
    for (int i = 0; i < rows; i++)
        matrix[i] = new int[cols]();
    return matrix;
}


// findMax findMin #########################################################################################################
#include <iostream>
#include <vector>
using namespace std;

int findMax(const vector<vector<int>>& arr);
int findMin(const vector<vector<int>>& arr);

int main() {
    cout << "----------------------------------------------------" << endl;

    vector<vector<int>> arr(3, vector<int>(4));
    int value = 1;
    for (auto& row : arr)
        for (auto& elem : row)
            elem = value++;

    cout << "max= " << findMax(arr) << endl;
    cout << "min= " << findMin(arr) << endl;
    cout << "----------------------------------------------------" << endl;
    return 0;
}

int findMax(const vector<vector<int>>& arr) {
    int max = arr[0][0];
    for (const auto& row : arr)
        for (const auto& elem : row)
            if (elem > max) max = elem;
    return max;
}

int findMin(const vector<vector<int>>& arr) {
    int min = arr[0][0];
    for (const auto& row : arr)
        for (const auto& elem : row)
            if (elem < min) min = elem;
    return min;
}
// findMax findMin (include index) #########################################################################################################
#include <iostream>
#include <vector>
using namespace std;

int findMaxMin(const vector<vector<int>>&);

int main() {
    cout << "----------------------------------------------------" << endl;

    vector<vector<int>> arr(2, vector<int>(5));
    arr = {{2,1,11,15,0}, {11,13,15,17,19}};

    for (auto& row : arr) {
        for (auto& elem : row)
            cout << elem << " ";
        cout << endl;
    }
    
	int result = findMaxMin(arr);
    cout << "max-min= " << result << endl;
    cout << "----------------------------------------------------" << endl;
    return 0;
}

int findMaxMin(const vector<vector<int>>& arr) {
    int max = arr[0][0];
    int min = arr[0][0];
    pair<int, int> max_idx = {0, 0};
    pair<int, int> min_idx = {0, 0};

    for (size_t i = 0; i < arr.size(); i++) {
        for (size_t j = 0; j < arr[0].size(); j++) {
            if (arr[i][j] > max) {
                max = arr[i][j];
                max_idx = {i, j};
            } else if (arr[i][j] < min) {
                min = arr[i][j];
                min_idx = {i, j};
            }
        }
    }
	cout << "max_idx(i,j): (" << max_idx.first << ", " << max_idx.second << ")" << endl;
	cout << "min_idx(i,j): (" << min_idx.first << ", " << min_idx.second << ")" << endl;
    return max - min;
}

// findMax findMin include index (range-based for loop) #####################################################################################
#include <iostream>
#include <vector>
using namespace std;

int findMaxMin(const vector<vector<int>>&);

int main() {
    cout << "----------------------------------------------------" << endl;

    vector<vector<int>> arr(2, vector<int>(5));
    arr = {{2,1,11,15,0}, {11,13,15,17,19}};

    for (auto& row : arr) {
        for (auto& elem : row)
            cout << elem << " ";
        cout << endl;
    }
    
	int result = findMaxMin(arr);
    cout << "max-min= " << result << endl;
    cout << "----------------------------------------------------" << endl;
    return 0;
}


int findMaxMin(const vector<vector<int>>& arr) {
    int max = arr[0][0];
    int min = arr[0][0];
    pair<int, int> max_idx = {0, 0};
    pair<int, int> min_idx = {0, 0};

    int row = 0;
    for (const auto& r : arr) {
        int col = 0;
        for (const auto& val : r) {
            if (val > max) {
                max = val;
                max_idx = {row, col};
            } else if (val < min) {
                min = val;
                min_idx = {row, col};
            }
            ++col;
        }
        ++row;
    }

    cout << "max_idx(i,j): (" << max_idx.first << ", " << max_idx.second << ")" << endl;
    cout << "min_idx(i,j): (" << min_idx.first << ", " << min_idx.second << ")" << endl;
    return max - min;
}





// C字串倒序印出 #########################################################################################################
#include <iostream>
using namespace std;

int main() {
    cout << "----------------------------------------------------" << endl;

    char str1[15];
    cout << "Enter a string: ";
    cin.getline(str1, 15);

    int len = 0;
    while (str1[len] != '\0') len++;

    for (int i = len - 1; i >= 0; i--)
        cout << str1[i];

    cout << endl;
    cout << "----------------------------------------------------" << endl;
    return 0;
}

// reverse C-style string #########################################################################################################
#include <iostream>
#include <cstring>  // for strlen
using namespace std;

void reverse(const char*, char*);

int main() {
    cout << "----------------------------------------------------" << endl;

    char src[15];
    cout << "Enter a string: ";
    cin.getline(src, 15);

    int len = strlen(src);
    char dest[15];

    reverse(src, dest);
    cout << src << endl;
    cout << dest << endl;

    cout << "----------------------------------------------------" << endl;
    return 0;
}

void reverse(const char* src, char* dest) {
    int len = strlen(src);
    for (int i = 0; i < len; ++i) {
        dest[i] = src[len - 1 - i];
    }
    dest[len] = '\0';
}

// reverse C++-style string ######################################################################################
#include <iostream>
#include <string>
using namespace std;

string reversed(const string& src) {
    string result;
    for (int i = src.length() - 1; i >= 0; --i) {
        result += src[i];
    }
    return result;
}

int main() {
    cout << "----------------------------------------------------" << endl;

    string str1;
    cout << "Enter a string: ";
    getline(cin, str1);

    string str2 = reversed(str1);

    cout << str2 << endl;

    cout << "----------------------------------------------------" << endl;
    return 0;
}

// countVowels #########################################################################################################
#include <iostream>
#include <string>
using namespace std;

void countVowels(const string& str1) {
    int A=0, E=0, I=0, O=0, U=0;
    for (char ch : str1) {
        switch (ch)
        {
        case 'A': case 'a':
            A += 1;
            break;
        case 'E': case 'e':
            E += 1;
            break;
        case 'I': case 'i':
            I += 1;
            break;
        case 'O': case 'o':
            O += 1;
            break;
        case 'U': case 'u':
            U += 1;
            break;
        }
    }
    cout << "A: " << A << endl;
    cout << "E: " << E << endl;
    cout << "I: " << I << endl;
    cout << "O: " << O << endl;
    cout << "U: " << U << endl;
}

int main() {
    cout << "----------------------------------------------------" << endl;

    string str1;
    cout << "Enter a string: ";
    getline(cin, str1);

    countVowels(str1);

    cout << "----------------------------------------------------" << endl;
    return 0;
}

//  #########################################################################################################
#include <iostream>
#include <vector>
#include <array>

using namespace std;

void PrintChar_1(const char *);
void PrintChar_2(const char *[], size_t);
void PrintChar_vec(const vector<string>&);

template <size_t N>
void PrintChar_array(const array<string, N>&);

int main() {
    const char *str1 = "Hello C++!";
    const char *str2[3]= {"Tom", "Lilly", "James Lee"};
    vector<string> strVec = {"Tom", "Lilly", "James Lee"};
    array<string, 3> strArray = {"Tom", "Lilly", "James Lee"};
    
    PrintChar_1(str1);
    PrintChar_2(str2, 3);
    PrintChar_vec(strVec);
    PrintChar_array(strArray);

    return 0;
}


void PrintChar_1(const char *str) {
    cout << str << endl;
    cout << endl;
}

void PrintChar_2(const char *str[], size_t size) {
    for(size_t i = 0; i < size; i++)
        cout << str[i] << endl;
    cout << endl;
}

void PrintChar_vec(const vector<string>& strVec) {
    for (const auto& str : strVec)
        cout << str << endl;
    cout << endl;
}

template <size_t N>
void PrintChar_array(const array<string, N>& strArray) {
    for (const auto& str : strArray)
        cout << str << endl;
    cout << endl;
}


// object, matrix #########################################################################################################
#include <iostream>

using namespace std;

class Caaa {
    private:
    int rows, cols, **a;
    
    public:
    Caaa(int, int, int);
    ~Caaa();
    void show();
    void set_number(int);
};

Caaa::Caaa(int num, int r=3, int c=4): rows(r), cols(c)  {
    a = new int*[rows];
    for(size_t i = 0; i < rows; ++i) {
        a[i] = new int[cols]();
        for (size_t j = 0; j < cols; ++j)
            a[i][j] = num;
    }
}
Caaa::~Caaa() {
    for(size_t i = 0; i < rows; ++i)
        delete[] a[i];
    delete[] a;
    cout << "destructor called" << endl;
}

void Caaa::show() {
    for (size_t i = 0; i<rows; ++i) {
        for (size_t j = 0; j<cols; ++j)
            cout << *(*(a+i)+j) << " ";
        cout << endl;
    }
    cout << endl;
}

void Caaa::set_number(int num) {
    for (size_t i = 0; i<rows; ++i)
        for (size_t j = 0; j<cols; ++j)
            *(*(a+i)+j) = num;
}


int main() {
    Caaa obj1 = Caaa(7, 2, 2);
    Caaa obj2 = Caaa(12, 3, 3);
    Caaa obj3 = Caaa(8);
    
    obj1.show();
    obj2.show();
    obj3.show();
    
    obj1.set_number(777);
    obj2.set_number(999);
    obj1.show();
    obj2.show();
    return 0;
}


// object, matrix(vector) #########################################################################################################
#include <iostream>
#include <vector>

using namespace std;

class Caaa {
    private:
    vector<vector<int>> a;
    
    public:
    Caaa(int, int, int);
    ~Caaa();
    void show();
    void set_number(int);
};

Caaa::Caaa(int num, int rows=3, int cols=4): a(rows, vector<int>(cols, num)) {}
Caaa::~Caaa() {
    cout << "destructor called" << endl;
}

void Caaa::show() {
    for (const auto& row: a) {
        for (const auto& elem: row)
            cout << elem << " ";
        cout << endl;
    }
    cout << endl;
}

void Caaa::set_number(int num) {
    for (auto& row: a)
        for (auto& elem: row)
            elem = num;
}


int main() {
    Caaa obj1 = Caaa(7, 2, 2);
    Caaa obj2 = Caaa(12, 3, 3);
    Caaa obj3 = Caaa(8);
    
    obj1.show();
    obj2.show();
    obj3.show();
    
    obj1.set_number(777);
    obj2.set_number(999);
    obj1.show();
    obj2.show();
    return 0;
}




//  #########################################################################################################

//  #########################################################################################################

//  #########################################################################################################




















// remove erase #######################################################################################################
vector<int> vec1 = {2, 21, 2, 3, 15, 17, 2};
vec1.erase(remove(vec1.begin(), vec1.end(), 2), vec1.end());







//  #########################################################################################################
sort(v.begin(), v.end(), [](int a, int b) {
    return a > b;
});
//  #########################################################################################################
template <class T>
struct greater {
    bool operator()(const T& a, const T& b) const {
        return a > b;
    }
};
//  #########################################################################################################
int arr[] = {21, 3, 15, 17, 2};
sort(arr, arr + 5);



